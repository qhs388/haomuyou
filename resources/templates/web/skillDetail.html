<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <meta name="browsermode" content="application">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="cache-control" content="no-cache">
    <meta http-equiv="expires" content="0">
    <meta http-equiv="Cache" content="no-cache">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0">
    <!-- 禁止百度转码 -->
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <!-- uc强制竖屏 -->
    <meta name="screen-orientation" content="portrait">
    <!-- QQ强制竖屏 -->
    <meta name="x5-orientation" content="portrait">
    <meta content="yes" name="apple-mobile-web-app-capable">
    <meta content="black" name="apple-mobile-web-app-status-bar-style">
    <meta name="format-detection" content="telephone=no">
    <title>${killData.goodsName!}</title>
    <link rel="stylesheet" href="${request.contextPath}/web/css/reset.css">
    <link rel="stylesheet" href="${request.contextPath}/web/css/bulk-purchase.css?v=${verison!}">
    <link rel="stylesheet" href="${request.contextPath}/web/css/swiper.min.css">
    <link rel="stylesheet" href="${request.contextPath}/web/css/base.css?v=${verison!}">
    <link rel="stylesheet" href="${request.contextPath}/plug/layui/css/layui.css" media="all">
    <style>
		.product-con .nav[data-v-4e300e16] {
			background-image: url(data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAAA8AAD/4QN/aHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MiA3OS4xNjA5MjQsIDIwMTcvMDcvMTMtMDE6MDY6MzkgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6NDNlZTU0ZDMtNjEwZS03ZjQ4LWEwODgtNTZlMTZiNzI3NTQwIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjI1NEI2MDUyM0ZDMjExRTk5OTg1REI1OUM1NjNEMUZCIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjI1NEI2MDUxM0ZDMjExRTk5OTg1REI1OUM1NjNEMUZCIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE4IChXaW5kb3dzKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjUyMDIzNWNmLTIwNGYtOTQ0My05YTBiLWNmMmZlMTJmMDk3NCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo0M2VlNTRkMy02MTBlLTdmNDgtYTA4OC01NmUxNmI3Mjc1NDAiLz4gPC9yZGY6RGVzY3JpcHRpb24+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);
			background-repeat: no-repeat;
			background-size: 100% 100%;
			width: 100%;
			height: 50px;
			padding: 0 15px;
			box-sizing: border-box;
		}
		.product-con .nav .money[data-v-4e300e16] {
			font-size: 14px;
			color: #fff;
		}
		uni-view {
			box-sizing: border-box;
		}
		.product-con .nav .money .num[data-v-4e300e16] {
			font-size: 24px;
		}
		.product-con .nav .money .y-money[data-v-4e300e16] {
			font-size: 13px;
			margin-left: 5px;
			text-decoration: line-through;
		}
		.product-con .wrapperRush .introduce .infor {
            width: 91%;
            font-size: .32rem;
            font-weight: 700;
        }
        .product-con .wrapperRush .introduce .iconfont {
            font-size: .37rem;
            color: #515151;
        }
	</style>
</head>
<script type="text/javascript" src="${request.contextPath}/web/js/media_750.js"></script>
<script type="text/javascript" src="${request.contextPath}/web/js/jquery.min.js"></script>
<script type="text/javascript" src="${request.contextPath}/web/js/jquery.mobile.min.js"></script>
<script type="text/javascript" src="${request.contextPath}/web/js/swiper.min.js"></script>
<script type="text/javascript" src="${request.contextPath}/web/js/common.js"></script>
<script src="${request.contextPath}/js/layer.js"></script>
<body style="background-color: rgb(245, 245, 245);">
<div data-role="page">
    <div class="app">
        <div class="router product-con">
            <div id="title0">
                <div class="slider-banner product-bg">
                    <div class="swiper-container swiper-container-initialized swiper-container-horizontal swiper-container-ios">
                        <div class="swiper-wrapper">
                            <#if data.sliderImages??>
                                <#list data.sliderImages as item>
                                    <div class="swiper-slide">
                                        <div class="slide-image"
                                             style="background: url(${item}) center center / 100% 100% no-repeat;">
                                        </div>
                                    </div>
                                </#list>
                            </#if>
                        </div>
                        <div class="pages"></div>
                    </div>
                </div>
                <div class="icon-fenxiang">
                    <img  src="/web/images/share.png" class="image">
                </div>
                <div class="wrapper">
                    <uni-view data-v-4e300e16="" class="nav acea-row row-between-wrapper">
                        <uni-view data-v-4e300e16="" class="money">
                            ￥
                            <uni-text data-v-4e300e16="" class="num">
                                <span>${killData.webSeckillPrice!}</span>
                            </uni-text>
                            <uni-text data-v-4e300e16="" class="y-money">
                                <span>￥${killData.webGoodsPrice!}</span>
                            </uni-text>
                        </uni-view>
                        <uni-view data-v-4e300e16="" class="acea-row row-middle"></uni-view>
                    </uni-view>
                    <div class="introduce acea-row row-between">
                        <div class="infor">${killData.goodsName!}</div>
                    </div>
                    <div class="label acea-row row-between-wrapper">
                        <div>累计销量:${killData.sales!}件</div>
                        <div>限量:${killData.num!}件</div>
                    </div>
                </div>
            </div>
            <span class="atterTxt" style="display:none;"></span>
            <div id="title1" class="userEvaluation">
                <div class="title acea-row row-between-wrapper">
                    <div>用户评价(${countData.all!})</div>
                    <a href="${request.contextPath}/web/commentList/0/${data.id!}" class="praise">
                        <span class="font-color-red">${countData.goodPercent!}</span>
                        好评率
                        <span class="iconfont icon-jiantou"></span>
                    </a>
                </div>
                <div class="evaluateWtapper">
                    <#if comment??>
                        <#list comment as item>
                            <#if item_index == 0>
                                <div class="evaluateItem">
                                    <div class="pic-text acea-row row-middle">
                                        <div class="pictrue">
                                            <img src="${item.userImage}" class="image"/>
                                        </div>
                                        <div class="acea-row row-middle">
                                            <div class="name line1">${item.userName!}</div>
                                            <div class="start star${item.star!}">

                                            </div>
                                        </div>
                                    </div>
                                    <div class="time">${item.createDate?string("yyyy-MM-dd HH:mm:ss")}</div>
                                    <div class="evaluate-infor">${item.comment!}</div>
                                    <div class="imgList acea-row">
                                    </div>
                                </div>
                            </#if>
                        </#list>
                    </#if>
                </div>
            </div>
            <div id="title2" class="product-intro">
                <div class="title">产品介绍</div>
                <div class="conter">
                    <p>
                        ${data.content!}
                    </p>
                </div>
            </div>
            <div style="height: 1.2rem"></div>
            <div class="footer-group acea-row row-between-wrapper">
                <div class="customerSer acea-row row-center-wrapper row-column">
                    <a href="https://mp.weixin.qq.com/mp/profile_ext?action=home&__biz=MzUxODE1MDI4Mg==&scene=124#wechat_redirect" class="item animated">
                        <div  class="iconfont icon-kefu">
                        </div>
                        <div >客服</div>
                    </a>
                </div>
                <div class="bnt bg-color-violet singlePruchase" data-id="${data.id!}">单独购买</div>
                <div class="bnt bg-color-red bulkPurchase">立即秒杀</div>
            </div>
            <div>
                <div class="product-window group-con">
                    <div class="textpic acea-row row-between-wrapper">
                        <div class="pictrue">
                            <img class="image" src="${killData.goodsImage!}">
                        </div>
                        <div class="text">
                            <div class="line1">
                                ${killData.goodsName!}
                            </div>
                            <div class="money font-color-red">
                                ￥<span class="num"> ${killData.webSeckillPrice!}</span>
                                <span class="stock">库存: ${killData.stock!}</span>
                            </div>
                        </div>
                        <div class="iconfont icon-guanbi">

                        </div>
                    </div>
                    <div class="productWinList">
                        <#if data.specType == '0'>
                            <div class="item">
                                <div class="title">规格</div>
                                <div class="listn acea-row row-middle">
                                    <div  class="itemn on">
                                        默认
                                    </div>
                                </div>
                            </div>
                            <#else>
                                <#if data.items??>
                                    <#list data.items as item>
                                        <div class="item">
                                            <div class="title">${item.value}</div>
                                            <div class="listn acea-row row-middle">
                                                <#list item.detail as attr>
                                                    <div  class="itemn">
                                                        ${attr}
                                                    </div>
                                                </#list>
                                            </div>
                                        </div>
                                    </#list>
                                </#if>
                        </#if>
                    </div>
                    <div class="cart">
                        <div class="title">数量</div>
                        <div class="carnum acea-row row-left">
                            <div class="item reduce on">-</div>
                            <div class="item num">
                                <input type="number" class="ipt_num" value="1">
                            </div>
                            <div class="item plus">+</div>
                        </div>
                    </div>
                </div>
                <#include "include/share.html" />
                <div class="mask" style="display: none"></div>
            </div>
        </div>
    </div>
    <#include "include/right.html" />
</div>
</body>
<script>
    var type = '${data.specType!}';
    var attrData = attrData();
    $(function () {
        var mySwiper = new Swiper('.swiper-container', {
            // 轮播图的方向，也可以是vertical方向
            direction: 'horizontal',
            //播放速度
            loop: true,
            // 自动播放时间
            autoplay: true,
            // 播放的速度
            speed: 1000,
            // 这样，即使我们滑动之后， 定时器也不会被清除
            autoplayDisableOnInteraction: false
        });
        var attrList = [];
        $('.bulkPurchase').on('touchstart', function () {
           var isOpen = $(".product-window").hasClass('on');
            if(isOpen){
                var obj = new Object();
                var attrSize = $(".productWinList").children(".item").length;
                var selectSize = $(".itemn.on").length;
                var attr;
                if(type == '1'){
                    attr = $('.atterTxt').html().replace(/\s+/g, "");
                    if(attr == '' || selectSize != attrSize){
                        layer.msg("请选择全部规则！")
                        return;
                    }
                }else{
                    attr = "默认";
                }

                var number = $(".ipt_num").val();
                if(number < 1){
                    layer.msg("请选择数量！")
                    return;
                }
                obj["id"] = ${killData.id!};
                obj["goodsAttr"] = attr;
                obj["totalNum"] = number;
                obj["goodsId"] = ${data.id};
                $.ajax({
                      type: 'POST',
                      url: '${request.contextPath}/web/order/addSkillOrder',
                      data: JSON.stringify(obj),
                      dataType:'json',
                      contentType:'application/json',
                      success: function(data){
                          if(data.code==200){
                                $('.mask').hide();
                                $('.product-window').removeClass('on');
                                window.location.href="${request.contextPath}/web/orderSubmit/" + data.data
                          }else{
                             layer.msg(data.msg)
                          }
                      }
                });
            }else{
             $('.mask').show();
             $('.product-window').addClass('on');
            }
        })
        $(".singlePruchase").on('touchstart', function () {
            window.location.href='${request.contextPath}/web/goodsDetail/'+$(this).data("id");
        })
        $('.iconfont.icon-guanbi, .mask').on('touchstart', function () {
            $('.mask').hide();
            $('.product-window').removeClass('on');
            $('.generate-posters').removeClass('on');
            $('.poster-first').removeClass('on');
            $('.haibao-first').removeClass('on');
        })
        if ($('.listn .itemn')[0]) {
            $('.listn .itemn').on('touchstart', function () {
                var $this = $(this);
                var $item = $($this.parents('.item')[0]);
                $(this).parent().find('.itemn').removeClass('on')
                $this.addClass('on');
                attrList[$item.index()] = $this.html();
                var attr = attrList.join(',').replace(/\s+/g, "");
                $('.atterTxt').html(attr)
                 if(type == '1' && attrData.get(attr) != undefined){
                    var attrObj = attrData.get(attr);
                    $('.product-window .pictrue .image').attr('src',attrObj.image);
                 }
            })
        }
    })
     function attrData(){
            var map = new Map();
            <#if data.attrs??>
                <#if data.attrs?size gt 0>
                    <#list data.attrs as item>
                        var attrObject = new Object();
                        attrObject.suk = '${item.suk!}';
                        attrObject.stock = '${item.stock!}';
                        attrObject.price = '${item.price!}';
                        attrObject.vipPrice = '${item.vipPrice!}';
                        attrObject.image = '${item.image!}';
                        map.set(attrObject.suk,attrObject);
                    </#list>
                </#if>
            </#if>
            return map;
        }
</script>
</html>